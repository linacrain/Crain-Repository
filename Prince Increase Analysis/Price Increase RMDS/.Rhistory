mutate(`Category`=factor(`Category`,levels=c("Second Price Increase (12/15/2023 Onwards)","Initial Price Increase (5/1/2023 - 12/14/2023)")))%>%
ggplot(aes(x = .epred_prop, y = Category, fill = Category))+stat_halfeye()+theme_minimal()+labs(x="Proportion of New Users who subscribe at Premium Annual",y=NULL)+guides(fill="none")+scale_x_continuous(labels = label_percent())
premium_annual_beta_binomial%>%
tidybayes::epred_draws(newdata = premium_annual)%>%
mutate(`Category`=ifelse(str_detect(category,"pre_2nd"),"Initial Price Increase (5/1/2023 - 12/14/2023)",
"Second Price Increase (12/15/2023 Onwards)"))%>%
mutate(.epred_prop = .epred / total_contracts) %>%
mutate(`Category`=factor(`Category`,levels=c("Second Price Increase (12/15/2023 Onwards)","Initial Price Increase (5/1/2023 - 12/14/2023)")))%>%
ggplot(aes(x = .epred_prop, y = reorder(Category), fill = Category))+stat_halfeye()+theme_minimal()+labs(x="Proportion of New Users who subscribe at Premium Annual",y=NULL)+guides(fill="none")+scale_x_continuous(labels = label_percent())
premium_annual_beta_binomial%>%
tidybayes::epred_draws(newdata = premium_annual)%>%
mutate(`Category`=ifelse(str_detect(category,"pre_2nd"),"Initial Price Increase (5/1/2023 - 12/14/2023)",
"Second Price Increase (12/15/2023 Onwards)"))%>%
mutate(.epred_prop = .epred / total_contracts) %>%
mutate(`Category`=factor(`Category`,levels=c("Second Price Increase (12/15/2023 Onwards)","Initial Price Increase (5/1/2023 - 12/14/2023)")))%>%
ggplot(aes(x = .epred_prop, y = -Category, fill = Category))+stat_halfeye()+theme_minimal()+labs(x="Proportion of New Users who subscribe at Premium Annual",y=NULL)+guides(fill="none")+scale_x_continuous(labels = label_percent())
premium_annual_beta_binomial%>%
tidybayes::epred_draws(newdata = premium_annual)%>%
mutate(`Category`=ifelse(str_detect(category,"pre_2nd"),"Initial Price Increase (5/1/2023 - 12/14/2023)",
"Second Price Increase (12/15/2023 Onwards)"))%>%
mutate(.epred_prop = .epred / total_contracts) %>%
mutate(`Category`=factor(`Category`,levels=c("Second Price Increase (12/15/2023 Onwards)","Initial Price Increase (5/1/2023 - 12/14/2023)")))%>%
ggplot(aes(x = .epred_prop, y = Category, fill = Category))+stat_halfeye()+theme_minimal()+labs(x="Proportion of New Users who subscribe at Premium Annual",y=NULL)+guides(fill="none")+scale_x_continuous(labels = label_percent())
premium_annual_beta_binomial%>%
tidybayes::epred_draws(newdata = premium_annual)%>%
mutate(`Category`=ifelse(str_detect(category,"pre_2nd"),"Initial Price Increase (5/1/2023 - 12/14/2023)",
"Second Price Increase (12/15/2023 Onwards)"))%>%
mutate(.epred_prop = .epred / total_contracts) %>%
mutate(`Category`=factor(`Category`,levels=c("Second Price Increase (12/15/2023 Onwards)","Initial Price Increase (5/1/2023 - 12/14/2023)")))%>%
arrange(Category)%>%
ggplot(aes(x = .epred_prop, y = Category, fill = Category))+stat_halfeye()+theme_minimal()+labs(x="Proportion of New Users who subscribe at Premium Annual",y=NULL)+guides(fill="none")+scale_x_continuous(labels = label_percent())
premium_annual_beta_binomial%>%
tidybayes::epred_draws(newdata = premium_annual)%>%
mutate(`Category`=ifelse(str_detect(category,"pre_2nd"),"Initial Price Increase (5/1/2023 - 12/14/2023)",
"Second Price Increase (12/15/2023 Onwards)"))%>%
mutate(.epred_prop = .epred / total_contracts) %>%
mutate(`Category`=factor(`Category`,levels=c("Second Price Increase (12/15/2023 Onwards)","Initial Price Increase (5/1/2023 - 12/14/2023)")))%>%
arrange(-Category)%>%
ggplot(aes(x = .epred_prop, y = Category, fill = Category))+stat_halfeye()+theme_minimal()+labs(x="Proportion of New Users who subscribe at Premium Annual",y=NULL)+guides(fill="none")+scale_x_continuous(labels = label_percent())
premium_annual_beta_binomial%>%
tidybayes::epred_draws(newdata = premium_annual)%>%
mutate(`Category`=ifelse(str_detect(category,"pre_2nd"),"Initial Price Increase (5/1/2023 - 12/14/2023)",
"Second Price Increase (12/15/2023 Onwards)"))%>%
mutate(.epred_prop = .epred / total_contracts) %>%
mutate(`Category`=factor(`Category`,levels=c("Second Price Increase (12/15/2023 Onwards)","Initial Price Increase (5/1/2023 - 12/14/2023)")))%>%
ggplot(aes(x = .epred_prop, y = forcats::fct_inorder(Category), fill = Category))+stat_halfeye()+theme_minimal()+labs(x="Proportion of New Users who subscribe at Premium Annual",y=NULL)+guides(fill="none")+scale_x_continuous(labels = label_percent())
premium_annual_beta_binomial%>%
epred_draws(newdata = premium_annual) %>%
mutate(.epred_prop = .epred / total_contracts) %>%
ungroup() %>%
mutate(category = fct_relevel(category))%>%
compare_levels(.epred_prop, by = category,
comparison = "pairwise")%>%
ggplot(aes(x = .epred_prop)) +
stat_halfeye() +
scale_x_continuous(labels = label_percent(), expand = c(0, 0.015)) +
guides(fill = "none") +
labs(x = "Percentage Point Diff in Proportions (Premium Annual)",
y = NULL) +
theme_minimal()
premium_annual_beta_binomial%>%
epred_draws(newdata = premium_annual) %>%
mutate(.epred_prop = .epred / total_contracts) %>%
ungroup() %>%
mutate(category = fct_relevel(category))%>%
compare_levels(.epred_prop, by = category,
comparison = "pairwise")%>%
mutate(`95q`=quantile(.epred_prop,0.95),
`5q`=quantile(.epred_prop,0.05))
premium_annual_beta_binomial%>%
epred_draws(newdata = premium_annual) %>%
mutate(.epred_prop = .epred / total_contracts) %>%
ungroup() %>%
mutate(category = fct_relevel(category))%>%
compare_levels(.epred_prop, by = category,
comparison = "pairwise")%>%
mutate(`95q`=quantile(.epred_prop,0.95),
`5q`=quantile(.epred_prop,0.05),
m=median(.epred_prop))
knitr::kable(full_table%>%
mutate(`Product`=pubcode,
`Term Length`=termlength,
`New Orders`=n_contracts,
`Total New Orders`=total_contracts,
`Category`=ifelse(str_detect(category,"pre_2nd"),"Initial Price Increase (5/1/2023 - 12/14/2023)",
"Second Price Increase (12/15/2023 Onwards)"),
`Proportion of Orders`=paste(prop*100,'%',sep=''))%>%
mutate(`Category`=factor(`Category`,levels=c("Second Price Increase (12/15/2023 Onwards)","Initial Price Increase (5/1/2023 - 12/14/2023)")))%>%
arrange(`Category`)%>%
select(`Category`,`Product`,`Term Length`,`New Orders`,`Total New Orders`,`Proportion of Orders`)%>%
filter(Product=="Premium"&`Term Length`=="Annual"))
knitr::kable(full_table%>%
mutate(`Product`=pubcode,
`Term Length`=termlength,
`New Orders`=n_contracts,
`Total New Orders`=total_contracts,
`Category`=ifelse(str_detect(category,"pre_2nd"),"Initial Price Increase (5/1/2023 - 12/14/2023)",
"Second Price Increase (12/15/2023 Onwards)"),
`Proportion of Orders`=paste(prop*100,'%',sep=''))%>%
mutate(`Category`=factor(`Category`,levels=c("Second Price Increase (12/15/2023 Onwards)","Initial Price Increase (5/1/2023 - 12/14/2023)")))%>%
arrange(`Category`)%>%
select(`Category`,`Product`,`Term Length`,`New Orders`,`Total New Orders`,`Proportion of Orders`)%>%
filter(Product=="Premium"&`Term Length`=="Annual"))
premium_annual_beta_binomial%>%
tidybayes::epred_draws(newdata = premium_annual)%>%
mutate(`Category`=ifelse(str_detect(category,"pre_2nd"),"Initial Price Increase (5/1/2023 - 12/14/2023)",
"Second Price Increase (12/15/2023 Onwards)"))%>%
mutate(.epred_prop = .epred / total_contracts) %>%
mutate(`Category`=factor(`Category`,levels=c("Second Price Increase (12/15/2023 Onwards)","Initial Price Increase (5/1/2023 - 12/14/2023)")))%>%
ggplot(aes(x = .epred_prop, y = forcats::fct_inorder(Category), fill = Category))+stat_halfeye()+theme_minimal()+labs(x="Proportion of New Users who subscribe at Premium Annual",y=NULL)+guides(fill="none")+scale_x_continuous(labels = label_percent())
knitr::kable(full_table%>%
mutate(`Product`=pubcode,
`Term Length`=termlength,
`New Orders`=n_contracts,
`Total New Orders`=total_contracts,
`Category`=ifelse(str_detect(category,"pre_2nd"),"Initial Price Increase (5/1/2023 - 12/14/2023)",
"Second Price Increase (12/15/2023 Onwards)"),
`Proportion of Orders`=paste(prop*100,'%',sep=''))%>%
mutate(`Category`=factor(`Category`,levels=c("Second Price Increase (12/15/2023 Onwards)","Initial Price Increase (5/1/2023 - 12/14/2023)")))%>%
arrange(`Category`)%>%
select(`Category`,`Product`,`Term Length`,`New Orders`,`Total New Orders`,`Proportion of Orders`)%>%
filter(Product=="Basic Digital"&`Term Length`=="Annual"))
knitr::kable(full_table%>%
mutate(`Product`=pubcode,
`Term Length`=termlength,
`New Orders`=n_contracts,
`Total New Orders`=total_contracts,
`Category`=ifelse(str_detect(category,"pre_2nd"),"Initial Price Increase (5/1/2023 - 12/14/2023)",
"Second Price Increase (12/15/2023 Onwards)"),
`Proportion of Orders`=paste(prop*100,'%',sep=''))%>%
mutate(`Category`=factor(`Category`,levels=c("Second Price Increase (12/15/2023 Onwards)","Initial Price Increase (5/1/2023 - 12/14/2023)")))%>%
arrange(`Category`)%>%
select(`Category`,`Product`,`Term Length`,`New Orders`,`Total New Orders`,`Proportion of Orders`)%>%
filter(Product!="Premium"&`Term Length`=="Monthly"))
knitr::kable(full_table%>%
mutate(`Product`=pubcode,
`Term Length`=termlength,
`New Orders`=n_contracts,
`Total New Orders`=total_contracts,
`Category`=ifelse(str_detect(category,"pre_2nd"),"Initial Price Increase (5/1/2023 - 12/14/2023)",
"Second Price Increase (12/15/2023 Onwards)"),
`Proportion of Orders`=paste(prop*100,'%',sep=''))%>%
mutate(`Category`=factor(`Category`,levels=c("Second Price Increase (12/15/2023 Onwards)","Initial Price Increase (5/1/2023 - 12/14/2023)")))%>%
arrange(`Category`)%>%
select(`Category`,`Product`,`Term Length`,`New Orders`,`Total New Orders`,`Proportion of Orders`)%>%
filter(Product!="Premium"&`Term Length`!="Monthly"))
knitr::kable(full_table%>%
mutate(`Product`=pubcode,
`Term Length`=termlength,
`New Orders`=n_contracts,
`Total New Orders`=total_contracts,
`Category`=ifelse(str_detect(category,"pre_2nd"),"Initial Price Increase (5/1/2023 - 12/14/2023)",
"Second Price Increase (12/15/2023 Onwards)"),
`Proportion of Orders`=paste(prop*100,'%',sep=''))%>%
mutate(`Category`=factor(`Category`,levels=c("Second Price Increase (12/15/2023 Onwards)","Initial Price Increase (5/1/2023 - 12/14/2023)")))%>%
arrange(`Category`)%>%
select(`Category`,`Product`,`Term Length`,`New Orders`,`Total New Orders`,`Proportion of Orders`)%>%
filter(Product!="Premium"|`Term Length`!="Monthly"))
premium_annual_beta_binomial%>%
epred_draws(newdata = premium_annual) %>%
mutate(.epred_prop = .epred / total_contracts) %>%
ungroup() %>%
mutate(category = fct_relevel(category))%>%
compare_levels(.epred_prop, by = category,
comparison = "pairwise")%>%
ggplot(aes(x = .epred_prop)) +
stat_halfeye() +
scale_x_continuous(labels = label_percent(), expand = c(0, 0.015)) +
guides(fill = "none") +
labs(x = "Percentage Point Diff in Proportions (Premium Annual)",
y = NULL) +
theme_minimal()
basic_digital_beta_binomial%>%
tidybayes::epred_draws(newdata = basic_digital_annual)%>%
mutate(`Category`=ifelse(str_detect(category,"pre_2nd"),"Initial Price Increase (5/1/2023 - 12/14/2023)",
"Second Price Increase (12/15/2023 Onwards)"))%>%
mutate(.epred_prop = .epred / total_contracts) %>%
mutate(`Category`=factor(`Category`,levels=c("Second Price Increase (12/15/2023 Onwards)","Initial Price Increase (5/1/2023 - 12/14/2023)")))%>%
ggplot(aes(x = .epred_prop, y = forcats::fct_inorder(Category), fill = Category))+stat_halfeye()+theme_minimal()+labs(x="Proportion of New Users who subscribe at Basic Digital Annual",y=NULL)+guides(fill="none")+scale_x_continuous(labels = label_percent())
basic_digital_beta_binomial%>%
epred_draws(newdata = basic_digital_annual) %>%
mutate(.epred_prop = .epred / total_contracts) %>%
ungroup() %>%
mutate(category = fct_relevel(category))%>%
compare_levels(.epred_prop, by = category,
comparison = "pairwise")%>%
ggplot(aes(x = .epred_prop)) +
stat_halfeye() +
scale_x_continuous(labels = label_percent(), expand = c(0, 0.015)) +
guides(fill = "none") +
labs(x = "Percentage Point Diff in Proportions (Basic Digital Annual)",
y = NULL) +
theme_minimal()
basic_digital_beta_binomial%>%
epred_draws(newdata = premium_annual) %>%
mutate(.epred_prop = .epred / total_contracts) %>%
ungroup() %>%
mutate(category = fct_relevel(category))%>%
compare_levels(.epred_prop, by = category,
comparison = "pairwise")%>%
mutate(`95q`=quantile(.epred_prop,0.95),
`5q`=quantile(.epred_prop,0.05),
m=median(.epred_prop))
basic_digital_beta_binomial%>%
epred_draws(newdata = basic_digital_annual) %>%
mutate(.epred_prop = .epred / total_contracts) %>%
ungroup() %>%
mutate(category = fct_relevel(category))%>%
compare_levels(.epred_prop, by = category,
comparison = "pairwise")%>%
mutate(`95q`=quantile(.epred_prop,0.95),
`5q`=quantile(.epred_prop,0.05),
m=median(.epred_prop))
full_table
basic_digital_monthly<-full_table%>%
filter(pubcode=="Basic Digital"&termlength=="Monthly")
basic_digital_monthly
basic_digital_monthly_beta_binomial <- brm(
bf(n_contracts | trials(total_contracts) ~ 0 + category),
data = basic_digital_monthly,
family = binomial(link = "identity"),
prior = c(prior(beta(1, 1), class = "b", dpar = "mu", lb = 0, ub = 1)),
chains = CHAINS, warmup = WARMUP, iter = ITER, seed = BAYES_SEED,
refresh = 0
)
basic_digital_monthly_beta_binomial%>%
tidybayes::epred_draws(newdata = basic_digital_monthly)%>%
mutate(`Category`=ifelse(str_detect(category,"pre_2nd"),"Initial Price Increase (5/1/2023 - 12/14/2023)",
"Second Price Increase (12/15/2023 Onwards)"))%>%
mutate(.epred_prop = .epred / total_contracts) %>%
mutate(`Category`=factor(`Category`,levels=c("Second Price Increase (12/15/2023 Onwards)","Initial Price Increase (5/1/2023 - 12/14/2023)")))%>%
ggplot(aes(x = .epred_prop, y = forcats::fct_inorder(Category), fill = Category))+stat_halfeye()+theme_minimal()+labs(x="Proportion of New Users who subscribe at Basic Digital Annual",y=NULL)+guides(fill="none")+scale_x_continuous(labels = label_percent())
basic_digital_beta_binomial%>%
epred_draws(newdata = basic_digital_annual) %>%
mutate(.epred_prop = .epred / total_contracts) %>%
ungroup() %>%
mutate(category = fct_relevel(category))%>%
compare_levels(.epred_prop, by = category,
comparison = "pairwise")%>%
ggplot(aes(x = .epred_prop)) +
stat_halfeye() +
scale_x_continuous(labels = label_percent(), expand = c(0, 0.015)) +
guides(fill = "none") +
labs(x = "Percentage Point Diff in Proportions (Basic Digital Annual)",
y = NULL) +
theme_minimal()
basic_digital_monthly_beta_binomial%>%
epred_draws(newdata = basic_digital_monthly) %>%
mutate(.epred_prop = .epred / total_contracts) %>%
ungroup() %>%
mutate(category = fct_relevel(category))%>%
compare_levels(.epred_prop, by = category,
comparison = "pairwise")%>%
ggplot(aes(x = .epred_prop)) +
stat_halfeye() +
scale_x_continuous(labels = label_percent(), expand = c(0, 0.015)) +
guides(fill = "none") +
labs(x = "Percentage Point Diff in Proportions (Basic Digital Annual)",
y = NULL) +
theme_minimal()
knitr::kable(full_table%>%
mutate(`Product`=pubcode,
`Term Length`=termlength,
`New Orders`=n_contracts,
`Total New Orders`=total_contracts,
`Category`=ifelse(str_detect(category,"pre_2nd"),"Initial Price Increase (5/1/2023 - 12/14/2023)",
"Second Price Increase (12/15/2023 Onwards)"),
`Proportion of Orders`=paste(prop*100,'%',sep=''))%>%
mutate(`Category`=factor(`Category`,levels=c("Second Price Increase (12/15/2023 Onwards)","Initial Price Increase (5/1/2023 - 12/14/2023)")))%>%
arrange(`Category`)%>%
select(`Category`,`Product`,`Term Length`,`New Orders`,`Total New Orders`,`Proportion of Orders`)%>%
filter(Product=="Basic Digital"&`Term Length`=="Monthly"))
basic_digital_monthly_beta_binomial%>%
epred_draws(newdata = basic_digital_monthly) %>%
mutate(.epred_prop = .epred / total_contracts) %>%
ungroup() %>%
mutate(category = fct_relevel(category))%>%
compare_levels(.epred_prop, by = category,
comparison = "pairwise")%>%
ggplot(aes(x = .epred_prop)) +
stat_halfeye() +
scale_x_continuous(labels = label_percent(), expand = c(0, 0.015)) +
guides(fill = "none") +
labs(x = "Percentage Point Diff in Proportions (Basic Digital Annual)",
y = NULL) +
theme_minimal()
basic_digital_monthly_beta_binomial%>%
epred_draws(newdata = basic_digital_monthly) %>%
mutate(.epred_prop = .epred / total_contracts) %>%
ungroup() %>%
mutate(category = fct_relevel(category))%>%
compare_levels(.epred_prop, by = category,
comparison = "pairwise")%>%
mutate(`95q`=quantile(.epred_prop,0.95),
`5q`=quantile(.epred_prop,0.05),
m=median(.epred_prop))
sub_page_conv_rate<-an_price_increase_adobe%>%
mutate(category=ifelse(date<as.Date('12/15/2023',format="%m/%d/%Y"),"pre_2nd_price_increase","post_2nd_price_increase"))%>%
group_by(category)%>%
summarise(total_unique_visitors=sum(unique_visitors),
total_paid_orders=sum(new_paid_orders))%>%
mutate(subscription_landing_page_conv_rate=total_paid_orders/total_unique_visitors)%>%
mutate(category=as.factor(category))
sub_page_conv_rate_beta_binomial <- brm(
bf(total_paid_orders | trials(total_unique_visitors) ~ 0 + category),
data = sub_page_conv_rate,
family = binomial(link = "identity"),
prior = c(prior(beta(1, 1), class = "b", dpar = "mu", lb = 0, ub = 1)),
chains = CHAINS, warmup = WARMUP, iter = ITER, seed = BAYES_SEED,
refresh = 0
)
sub_page_conv_rate_beta_binomial%>%
tidybayes::epred_draws(newdata = sub_page_conv_rate)%>%
mutate(.epred_prop = .epred / total_unique_visitors) %>%
mutate(`Category`=ifelse(str_detect(category,"pre_2nd"),"Initial Price Increase (5/1/2023 - 12/14/2023)",
"Second Price Increase (12/15/2023 Onwards)"))%>%
ggplot(aes(x = .epred_prop, y = Category, fill = category))+stat_halfeye()+theme_minimal()+labs(x="Proportion of Visitors who convert during a visit with Sub Page",y=NULL)+guides(fill="none")+scale_x_continuous(labels = label_percent())
sub_page_conv_rate_beta_binomial%>%
tidybayes::epred_draws(newdata = sub_page_conv_rate)%>%
mutate(.epred_prop = .epred / total_unique_visitors) %>%
mutate(`Category`=ifelse(str_detect(category,"pre_2nd"),"Initial Price Increase (5/1/2023 - 12/14/2023)",
"Second Price Increase (12/15/2023 Onwards)"))%>%
ggplot(aes(x = .epred_prop, y = Category, fill = category))+stat_halfeye()+theme_minimal()+labs(x="Proportion of Visitors who convert during a visit with Sub Page",y=NULL)+guides(fill="none")+scale_x_continuous(labels = label_percent())
basic_digital_annual<-full_table%>%
filter(pubcode=="Basic Digital"&termlength=="Annual")%>%
mutate(category=as.factor(category))
sub_page_conv_rate
sub_page_conv_rate_beta_binomial
sub_page_conv_rate_beta_binomial <- brm(
bf(total_paid_orders | trials(total_unique_visitors) ~ 0 + factor(category)),
data = sub_page_conv_rate,
family = binomial(link = "identity"),
prior = c(prior(beta(1, 1), class = "b", dpar = "mu", lb = 0, ub = 1)),
chains = CHAINS, warmup = WARMUP, iter = ITER, seed = BAYES_SEED,
refresh = 0
)
saveRDS(sub_page_conv_rate_beta_binomial)
saveRDS(sub_page_conv_rate_beta_binomial,"sub_page_conv_rate_beta_binomial.rds")
sub_page_conv_rate_beta_binomial<-readRDS('sub_page_conv_rate_beta_binomial.rds')
sub_page_conv_rate_beta_binomial%>%
tidybayes::epred_draws(newdata = sub_page_conv_rate)%>%
mutate(.epred_prop = .epred / total_unique_visitors) %>%
mutate(`Category`=ifelse(str_detect(category,"pre_2nd"),"Initial Price Increase (5/1/2023 - 12/14/2023)",
"Second Price Increase (12/15/2023 Onwards)"))%>%
ggplot(aes(x = .epred_prop, y = Category, fill = category))+stat_halfeye()+theme_minimal()+labs(x="Proportion of Visitors who convert during a visit with Sub Page",y=NULL)+guides(fill="none")+scale_x_continuous(labels = label_percent())
saveRDS(premium_annual_beta_binomial)
saveRDS(premium_annual_beta_binomial,"premium_annual_beta_binomial.rds")
premium_annual_beta_binomial <- readRDS('premium_annual_beta_binomial.rds')
saveRDS(basic_digital_beta_binomial,'basic_digital_beta_binomial.rds')
basic_digital_beta_binomial <- readRDS('basic_digital_beta_binomial.rds')
basic_digital_beta_binomial%>%
tidybayes::epred_draws(newdata = basic_digital_annual)%>%
mutate(`Category`=ifelse(str_detect(category,"pre_2nd"),"Initial Price Increase (5/1/2023 - 12/14/2023)",
"Second Price Increase (12/15/2023 Onwards)"))%>%
mutate(.epred_prop = .epred / total_contracts) %>%
mutate(`Category`=factor(`Category`,levels=c("Second Price Increase (12/15/2023 Onwards)","Initial Price Increase (5/1/2023 - 12/14/2023)")))%>%
ggplot(aes(x = .epred_prop, y = forcats::fct_inorder(Category), fill = Category))+stat_halfeye()+theme_minimal()+labs(x="Proportion of New Users who subscribe at Basic Digital Annual",y=NULL)+guides(fill="none")+scale_x_continuous(labels = label_percent())
saveRDS(basic_digital_monthly_beta_binomial,'basic_digital_monthly_beta_binomial.rds')
basic_digital_monthly_beta_binomial <- readRDS('basic_digital_monthly_beta_binomial.rds')
write.csv(an_query,"an_price_increase_query.csv")
an_query_2<-read.csv('an_price_increase_query.csv')
an_query_2
repair_stanfit_names <- function(x) {
stopifnot(is.stanfit(x))
for (i in seq_along(x@sim$samples)) {
names(x@sim$samples[[i]]) <- x@sim$fnames_oi
}
x
}
knitr::kable(an_query%>%
filter(donortype=="I")%>%
filter(expirationissuedate>=as.Date("01-08-2024",format="%m-%d-%Y")&orderdate<=as.Date("12-15-2023",format="%m-%d-%Y"))%>%
filter(pubcode=="Basic Digital"|pubcode=="Premium")%>%
filter(termlength=="Annual")%>%
mutate(pubcode=ifelse(pubcode=="AN3","Digital All Access",pubcode))%>%
mutate(termnumber=as.numeric(termnumber))%>%
group_by(shiptocustomernumber,ordernumber,orderdate,pelcro_subid,isautorenew,pubcode,termnumber,termlength,rate,expirationissuedate)%>%
summarise(renewalrate=max(renewalrate),
renewalordernumber=n_distinct(renewalordernumber,na.rm=TRUE))%>%
ungroup()%>%
group_by(pubcode,isautorenew)%>%
filter(rate<=199)%>%
summarise(n_distinct_contracts=n_distinct(paste(shiptocustomernumber,ordernumber,pelcro_subid)),
n_distinct_renewals_pi=n_distinct(ifelse((renewalordernumber>0&pubcode=="Basic Digital"&renewalrate>=249)|(renewalordernumber>0&pubcode=="Premium"&renewalrate>=299)|renewalordernumber>0&renewalrate>=rate,paste(shiptocustomernumber,ordernumber,pelcro_subid),NA),na.rm=TRUE),
n_distinct_undetermined=n_distinct(ifelse(renewalordernumber==0&expirationissuedate>=today(),paste(shiptocustomernumber,ordernumber,pelcro_subid),NA),na.rm=TRUE),
n_distinct_churned=n_distinct(ifelse(renewalordernumber==0&expirationissuedate<today(),paste(shiptocustomernumber,ordernumber,pelcro_subid),NA),na.rm=TRUE),
mean_rate_renewal_price_increase=mean(ifelse((renewalordernumber>0&pubcode=="Basic Digital"&renewalrate>=249)|(renewalordernumber>0&pubcode=="Premium"&renewalrate>=299),rate,NA),na.rm=TRUE),
mean_rate_churn_price_increase=mean(ifelse(renewalordernumber==0&expirationissuedate<=today(),rate,NA),na.rm=TRUE),
mean_termnumber_renewal_pi=mean(ifelse((renewalordernumber>0&pubcode=="Basic Digital"&renewalrate>=249)|(renewalordernumber>0&pubcode=="Premium"&renewalrate>=299),termnumber,NA),na.rm=TRUE),
mean_termnumber_churn=mean(ifelse(renewalordernumber==0&expirationissuedate<=today(),termnumber,NA),na.rm=TRUE),
renewal_revenue_pi=sum(ifelse((renewalordernumber>0&pubcode=="Basic Digital"&renewalrate>=249)|(renewalordernumber>0&pubcode=="Premium"&renewalrate>=299),as.numeric(renewalrate),NA),na.rm=TRUE),
churn_loss=-1*sum(ifelse(renewalordernumber==0&expirationissuedate<=today()&pubcode=="Basic Digital",249,
ifelse(renewalordernumber==0&expirationissuedate<=today()&pubcode=="Premium",299,NA)),na.rm=TRUE),
total_renewal_revenue_post_price_increase=renewal_revenue_pi+churn_loss)%>%
mutate(Product=pubcode,
`Auto Renew`=isautorenew,
`Total Contracts`=n_distinct_contracts,
`Total Renewals at Increased Rate`=n_distinct_renewals_pi,
`Total Churned`=n_distinct_churned,
`Total Undetermined` = n_distinct_undetermined)%>%
ungroup()%>%
select(Product,`Auto Renew`,`Total Contracts`,`Total Renewals at Increased Rate`,`Total Churned`,`Total Undetermined`))
knitr::kable(sub_page_conv_rate%>%
mutate(`Category`=ifelse(str_detect(category,"pre_2nd"),"Initial Price Increase (5/1/2023 - 12/14/2023)",
"Second Price Increase (12/15/2023 Onwards)"),
`Unique Visitors`=total_unique_visitors,
`New Paid Orders`=total_paid_orders,
`Conversion Rate`=paste(round(subscription_landing_page_conv_rate,2)*100,'%',sep=''))%>%
select(`Category`,`Unique Visitors`,`New Paid Orders`,`Conversion Rate`))
premium_annual_beta_binomial%>%
tidybayes::epred_draws(newdata = premium_annual)%>%
mutate(`Category`=ifelse(str_detect(category,"pre_2nd"),"Initial Price Increase (5/1/2023 - 12/14/2023)",
"Second Price Increase (12/15/2023 Onwards)"))%>%
mutate(.epred_prop = .epred / total_contracts) %>%
mutate(`Category`=factor(`Category`,levels=c("Second Price Increase (12/15/2023 Onwards)","Initial Price Increase (5/1/2023 - 12/14/2023)")))%>%
ggplot(aes(x = .epred_prop, y = forcats::fct_inorder(Category), fill = Category))+stat_halfeye()+theme_minimal()+labs(x="Proportion of New Users who subscribe at Premium Annual",y=NULL)+guides(fill="none")+scale_x_continuous(labels = label_percent())
basic_digital_beta_binomial%>%
tidybayes::epred_draws(newdata = basic_digital_annual)%>%
mutate(`Category`=ifelse(str_detect(category,"pre_2nd"),"Initial Price Increase (5/1/2023 - 12/14/2023)",
"Second Price Increase (12/15/2023 Onwards)"))%>%
mutate(.epred_prop = .epred / total_contracts) %>%
mutate(`Category`=factor(`Category`,levels=c("Second Price Increase (12/15/2023 Onwards)","Initial Price Increase (5/1/2023 - 12/14/2023)")))%>%
ggplot(aes(x = .epred_prop, y = forcats::fct_inorder(Category), fill = Category))+stat_halfeye()+theme_minimal()+labs(x="Proportion of New Users who subscribe at Basic Digital Annual",y=NULL)+guides(fill="none")+scale_x_continuous(labels = label_percent())
basic_digital_monthly_beta_binomial%>%
tidybayes::epred_draws(newdata = basic_digital_monthly)%>%
mutate(`Category`=ifelse(str_detect(category,"pre_2nd"),"Initial Price Increase (5/1/2023 - 12/14/2023)",
"Second Price Increase (12/15/2023 Onwards)"))%>%
mutate(.epred_prop = .epred / total_contracts) %>%
mutate(`Category`=factor(`Category`,levels=c("Second Price Increase (12/15/2023 Onwards)","Initial Price Increase (5/1/2023 - 12/14/2023)")))%>%
ggplot(aes(x = .epred_prop, y = forcats::fct_inorder(Category), fill = Category))+stat_halfeye()+theme_minimal()+labs(x="Proportion of New Users who subscribe at Basic Digital Annual",y=NULL)+guides(fill="none")+scale_x_continuous(labels = label_percent())
basic_digital_monthly_beta_binomial%>%
tidybayes::epred_draws(newdata = basic_digital_monthly)%>%
mutate(`Category`=ifelse(str_detect(category,"pre_2nd"),"Initial Price Increase (5/1/2023 - 12/14/2023)",
"Second Price Increase (12/15/2023 Onwards)"))%>%
mutate(.epred_prop = .epred / total_contracts) %>%
mutate(`Category`=factor(`Category`,levels=c("Second Price Increase (12/15/2023 Onwards)","Initial Price Increase (5/1/2023 - 12/14/2023)")))%>%
ggplot(aes(x = .epred_prop, y = forcats::fct_inorder(Category), fill = Category))+stat_halfeye()+theme_minimal()+labs(x="Proportion of New Users who subscribe at Basic Digital Monthly",y=NULL)+guides(fill="none")+scale_x_continuous(labels = label_percent())
basic_digital_monthly_beta_binomial%>%
tidybayes::epred_draws(newdata = basic_digital_monthly)%>%
mutate(`Category`=ifelse(str_detect(category,"pre_2nd"),"Initial Price Increase (5/1/2023 - 12/14/2023)",
"Second Price Increase (12/15/2023 Onwards)"))%>%
mutate(.epred_prop = .epred / total_contracts) %>%
mutate(`Category`=factor(`Category`,levels=c("Second Price Increase (12/15/2023 Onwards)","Initial Price Increase (5/1/2023 - 12/14/2023)")))%>%
ggplot(aes(x = .epred_prop, y = forcats::fct_inorder(Category), fill = Category))+stat_halfeye()+theme_minimal()+labs(x="Proportion of New Users who subscribe at Basic Digital Monthly",y=NULL)+guides(fill="none")+scale_x_continuous(labels = label_percent())
basic_digital_monthly_beta_binomial%>%
tidybayes::epred_draws(newdata = basic_digital_monthly)%>%
mutate(`Category`=ifelse(str_detect(category,"pre_2nd"),"Initial Price Increase (5/1/2023 - 12/14/2023)",
"Second Price Increase (12/15/2023 Onwards)"))%>%
mutate(.epred_prop = .epred / total_contracts) %>%
mutate(`Category`=factor(`Category`,levels=c("Second Price Increase (12/15/2023 Onwards)","Initial Price Increase (5/1/2023 - 12/14/2023)")))%>%
ggplot(aes(x = .epred_prop, y = forcats::fct_inorder(Category), fill = Category))+stat_halfeye()+theme_minimal()+labs(x="Proportion of New Users who subscribe at Basic Digital Monthly",y=NULL)+guides(fill="none")+scale_x_continuous(labels = label_percent())
basic_digital_monthly_beta_binomial%>%
tidybayes::epred_draws(newdata = basic_digital_monthly)%>%
mutate(`Category`=ifelse(str_detect(category,"pre_2nd"),"Initial Price Increase (5/1/2023 - 12/14/2023)",
"Second Price Increase (12/15/2023 Onwards)"))%>%
mutate(.epred_prop = .epred / total_contracts) %>%
mutate(`Category`=factor(`Category`,levels=c("Second Price Increase (12/15/2023 Onwards)","Initial Price Increase (5/1/2023 - 12/14/2023)")))%>%
ggplot(aes(x = .epred_prop, y = forcats::fct_inorder(Category), fill = Category))+stat_halfeye()+theme_minimal()+labs(x="Proportion of New Users who subscribe at Basic Digital Monthly",y=NULL)+guides(fill="none")+scale_x_continuous(labels = label_percent())
basic_digital_monthly_beta_binomial%>%
epred_draws(newdata = basic_digital_monthly) %>%
mutate(.epred_prop = .epred / total_contracts) %>%
ungroup() %>%
mutate(category = fct_relevel(category))%>%
compare_levels(.epred_prop, by = category,
comparison = "pairwise")%>%
ggplot(aes(x = .epred_prop)) +
stat_halfeye() +
scale_x_continuous(labels = label_percent(), expand = c(0, 0.015)) +
guides(fill = "none") +
labs(x = "Percentage Point Diff in Proportions (Basic Digital Annual)",
y = NULL) +
theme_minimal()
basic_digital_monthly_beta_binomial%>%
epred_draws(newdata = basic_digital_monthly) %>%
mutate(.epred_prop = .epred / total_contracts) %>%
ungroup() %>%
mutate(category = fct_relevel(category))%>%
compare_levels(.epred_prop, by = category,
comparison = "pairwise")%>%
ggplot(aes(x = .epred_prop)) +
stat_halfeye() +
scale_x_continuous(labels = label_percent(), expand = c(0, 0.015)) +
guides(fill = "none") +
labs(x = "Percentage Point Diff in Proportions (Basic Digital Monthly)",
y = NULL) +
theme_minimal()
sub_page_conv_rate_beta_binomial<-readRDS('sub_page_conv_rate_beta_binomial.rds')
sub_page_conv_rate
sub_page_conv_rate_beta_binomial
sub_page_conv_rate<-an_price_increase_adobe%>%
mutate(category=ifelse(date<as.Date('12/15/2023',format="%m/%d/%Y"),"pre_2nd_price_increase","post_2nd_price_increase"))%>%
group_by(category)%>%
summarise(total_unique_visitors=sum(unique_visitors),
total_paid_orders=sum(new_paid_orders))%>%
mutate(subscription_landing_page_conv_rate=total_paid_orders/total_unique_visitors)
sub_page_conv_rate<-an_price_increase_adobe%>%
mutate(category=ifelse(date<as.Date('12/15/2023',format="%m/%d/%Y"),"pre_2nd_price_increase","post_2nd_price_increase"))%>%
group_by(category)%>%
summarise(total_unique_visitors=sum(unique_visitors),
total_paid_orders=sum(new_paid_orders))%>%
mutate(subscription_landing_page_conv_rate=total_paid_orders/total_unique_visitors)
sub_page_conv_rate_beta_binomial%>%
tidybayes::epred_draws(newdata = sub_page_conv_rate)
basic_digital_beta_binomial%>%
tidybayes::epred_draws(newdata = basic_digital_annual)
basic_digital_beta_binomial_table_for_gg<-basic_digital_beta_binomial%>%
tidybayes::epred_draws(newdata = basic_digital_annual)
write.csv(basic_digital_beta_binomial_table_for_gg,"basic_digital_beta_binomial_table_for_gg.csv",row.names = FALSE)
t<-read.csv("basic_digital_beta_binomial_table_for_gg.csv")
t%>%
mutate(.epred_prop = .epred / total_contracts) %>%
ggplot(aes(x = .epred_prop, y = category, fill = category))+stat_halfeye()+theme_minimal()+labs(x="Proportion of New Users who subscribe at Basic Digital Annual",y=NULL)+guides(fill="none")+scale_x_continuous(labels = label_percent())
