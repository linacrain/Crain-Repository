"0","an_adv_data%>%
  filter(donortype==""I"")%>%
  mutate(pub_code_level=ifelse(publicationcode==""AN1"",2,
                               ifelse(publicationcode==""AN3"",3,
                                      ifelse(publicationcode==""AN2"",1,
                                             ifelse(publicationcode==""AN4"",4,publicationcode)))))%>%
  group_by(shiptocustomernumber,subscriptionreference,ordernumber)%>%
  mutate(max_pub_code_level=max(pub_code_level,na.rm=TRUE))%>%
  mutate(total_rate=sum(rate),
         termnumber=max(termnumber),
         )%>%
  filter(pub_code_level=max_pub_code_level)
"
"1","[1m[33mError[39m in `filter()`:[22m
[38;5;232m[33m![38;5;232m We detected a named input.
[36mâ„¹[38;5;232m This usually means that you've used `=` instead of `==`.
[36mâ„¹[38;5;232m Did you mean `pub_code_level == max_pub_code_level`?[39m
Backtrace:
[90m 1. [39m... %>% filter(pub_code_level = max_pub_code_level)
[90m 3. [39m[1m[94mdplyr:::filter.data.frame([39m[22m., pub_code_level = max_pub_code_level[1m[94m)[39m[22m
"
