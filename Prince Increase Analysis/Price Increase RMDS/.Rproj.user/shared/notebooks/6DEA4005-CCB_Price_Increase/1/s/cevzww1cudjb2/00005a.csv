"0","migration_rows<-reduced%>%
  left_join(migration_rows,by=c('subscriptionreference'='adv_sub_id','ordernumber'='adv_order_number'))%>%
  filter(!is.na(rate.y))%>%
  mutate(original_adv_cust_value=shiptocustomernumber,
         pubcode=publicationcode.y,
         termlength=termlength.x,
         rate=rate.x,
         orderdate=orderdate.x,
         brand='CCB',
         adv_subid=subscriptionreference,
         pelcro_subid=subscriptionid,
         isautorenew=isautorenew.x,
         donortype=donortype.y,
         renewalordernumber=renewalordernumber.y,
         renewalrate=renewalrate.y,
         renewalstartdate=renewalstartdate.y
         )%>%
   select(shiptocustomernumber,original_adv_cust_value,ordernumber,orderdate,brand,pubcode,adv_subid,pelcro_subid,termnumber,isautorenew,startissuedate,expirationissuedate,rate,termlength,renewalordernumber,renewalrate,renewalstartdate,donortype)
"
"1","[1m[33mError[39m in `left_join()`:[22m
[38;5;232m[33m![38;5;232m Join columns in `y` must be present in the data.
[31mâœ–[38;5;232m Problem with `adv_sub_id` and `adv_order_number`.[39m
Backtrace:
[90m 1. [39m... %>% ...
[90m 6. [39m[1m[94mdplyr:::left_join.data.frame([39m[22m...[1m[94m)[39m[22m
"
