"0","segment_article_per_day_2023_ungrouped<-further_cleaned_mh%>%"
"0","  filter(Date<=as.Date(""2023-05-31"",format=""%Y-%m-%d""))%>%"
"0","  mutate(time_period=ifelse(Date<=as.Date(""2023-05-31"",format=""%Y-%m-%d""),""2023 Jan 1st to May 31st"",""2024 Jan 1st to May 31st""))%>%"
"0","  group_by(time_period)%>%"
"0","  mutate(month=month(Date),"
"0","         year=year(Date))%>%"
"0","  mutate(end_date=if_else(month==1,as.Date(""2023-01-31"",""%Y-%m-%d""),"
"0","                          if_else(month==2,as.Date(""2023-02-28"",""%Y-%m-%d""),"
"0","                                  if_else(month==3,as.Date(""2023-03-31"",""%Y-%m-%d""),"
"0","                                          if_else(month==4,as.Date(""2023-04-30"",""%Y-%m-%d""),as.Date(""2023-05-31"",""%Y-%m-%d""))))))%>%"
"0","  group_by(ref_id,month,year,end_date)%>%"
"0","  summarise(n_visits=n_distinct(Date),"
"0","            n_articles=sum(n_articles_visited))%>%"
"0","  ungroup()%>%"
"0","  mutate(visit_segment=ifelse(n_visits==0,""inactive"","
"0","                              ifelse(n_visits<2,""Casual Reader"","
"0","                                     ifelse(n_visits>=2&n_visits<=14,""Loyal Reader"",""Brand Lover""))))%>%"
"0","  mutate(articles_per_day=round(n_articles/n_visits,2))"
"1","[38;5;232m`summarise()` has grouped output by 'ref_id', 'month', 'year'. You can override using the `.groups` argument.[39m
"
"0","segment_article_per_day_2024_ungrouped<-further_cleaned_mh%>%"
"0","  filter(Date>=as.Date(""2024-01-01"",format=""%Y-%m-%d""))%>%"
"0","  mutate(time_period=ifelse(Date<=as.Date(""2023-05-31"",format=""%Y-%m-%d""),""2023 Jan 1st to May 31st"",""2024 Jan 1st to May 31st""))%>%"
"0","  group_by(time_period)%>%"
"0","  mutate(month=month(Date),"
"0","         year=year(Date))%>%"
"0","  mutate(end_date=if_else(month==1,as.Date(""2023-01-31"",""%Y-%m-%d""),"
"0","                          if_else(month==2,as.Date(""2023-02-28"",""%Y-%m-%d""),"
"0","                                  if_else(month==3,as.Date(""2023-03-31"",""%Y-%m-%d""),"
"0","                                          if_else(month==4,as.Date(""2023-04-30"",""%Y-%m-%d""),as.Date(""2023-05-31"",""%Y-%m-%d""))))))%>%"
"0","  group_by(ref_id,month,year,end_date)%>%"
"0","  summarise(n_visits=n_distinct(Date),"
"0","            n_articles=sum(n_articles_visited))%>%"
"0","  ungroup()%>%"
"0","  mutate(visit_segment=ifelse(n_visits==0,""inactive"","
"0","                              ifelse(n_visits<2,""Casual Reader"","
"0","                                     ifelse(n_visits>=2&n_visits<=14,""Loyal Reader"",""Brand Lover""))))%>%"
"0","  mutate(articles_per_day=round(n_articles/n_visits,2))"
"1","[38;5;232m`summarise()` has grouped output by 'ref_id', 'month', 'year'. You can override using the `.groups` argument.[39m
"
"0","segment_article_per_day_ungrouped<-rbind(segment_article_per_day_2023_ungrouped,segment_article_per_day_2024_ungrouped)"
