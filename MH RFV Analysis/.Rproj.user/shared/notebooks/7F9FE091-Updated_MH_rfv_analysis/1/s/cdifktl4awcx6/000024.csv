"0","rolled_up_mh<-mh_date_reduced%>%
  mutate(Date=as.Date(Date,format=""%B %d, %Y""))%>%
  mutate(`UID All (v60) (evar60)`=as.numeric(ifelse(`UID All (v60) (evar60)`==''|`UID All (v60) (evar60)`==""NO_ID"",NA,`UID All (v60) (evar60)`)))%>%
  group_by(Visitor_ID,`Visit Number`)%>%
  mutate(uid_max=max(`UID All (v60) (evar60)`,na.rm=TRUE))%>%
  left_join(clickshare_index_reduced,by=c(""uid_max""=""clickshareuserid""))%>%
  filter(!is.na(customermasterkey))%>%
  mutate(ref_id=customermasterkey)%>%
  group_by(ref_id)%>%
  arrange(Date,`Visit Number`,`Clicks to Page`,.by_group=TRUE)%>%
  select(ref_id,Date,Visitor_ID,`Visit Number`,`Clicks to Page`,`Content Type (v31) (evar31)`,`Page Name (v6) (evar6)`,`Mobile Device Type`)%>%
  group_by(ref_id,Visitor_ID,`Visit Number`,Date,`Mobile Device Type`)%>%
  arrange(`Visit Number`,`Clicks to Page`,.by_group=TRUE)%>%
  mutate(clicks_to_article=ifelse(`Content Type (v31) (evar31)`==""article"",`Clicks to Page`,NA))%>%
  mutate(did_sub=ifelse(str_detect(`Page Name (v6) (evar6)`,""subs:subscribe:"")&!is.na(`Page Name (v6) (evar6)`),1,0))%>%
  summarise(n_articles_visited=n_distinct(ifelse(`Content Type (v31) (evar31)`==""article"",`Page Name (v6) (evar6)`,NA),na.rm=TRUE),
            n_clicks_to_article=min(clicks_to_article,na.rm=TRUE),
            did_subscribe_during_visit=max(did_sub,na.rm=TRUE),
            n_non_article_pages_visited=n_distinct(ifelse(`Content Type (v31) (evar31)`!=""article""|is.na(`Content Type (v31) (evar31)`),`Page Name (v6) (evar6)`,NA),na.rm=TRUE))%>%
  mutate(ref_id=ifelse(is.infinite(ref_id),NA,ref_id),
         n_clicks_to_article=ifelse(is.infinite(n_clicks_to_article),NA,n_clicks_to_article))
"
"2","Warning:"
"2"," [38;5;232mThere were 81024 warnings in `mutate()`.
The first warning was:[39m
[38;5;232m[36mâ„¹[38;5;232m In argument: `uid_max = max(`UID All (v60) (evar60)`, na.rm = TRUE)`.
[36mâ„¹[38;5;232m In group 70: `Visitor_ID = ""1001004088305675721_6291744367173693744""` and `Visit Number = 1`.[39m
Caused by warning in `max()`:
[33m![39m no non-missing arguments to max; returning -Inf
[38;5;232m[36mâ„¹[38;5;232m Run ]8;;ide:run:dplyr::last_dplyr_warnings()dplyr::last_dplyr_warnings()]8;; to see the 81023 remaining warnings.[39m
"
"2","Registered S3 method overwritten by 'data.table':
  method           from
  print.data.table     
"
"2","Warning:"
"2"," [38;5;232mThere were 123212 warnings in `summarise()`.
The first warning was:[39m
[38;5;232m[36mâ„¹[38;5;232m In argument: `n_clicks_to_article = min(clicks_to_article, na.rm = TRUE)`.
[36mâ„¹[38;5;232m In group 5: `ref_id = ""MH0000629315 ""`, `Visitor_ID = ""3031339894524159934_6744827709742929512""`, `Visit Number =
  6`, `Date = 2023-04-07`, `Mobile Device Type = ""Other""`.[39m
Caused by warning in `min()`:
[33m![39m no non-missing arguments to min; returning Inf
[38;5;232m[36mâ„¹[38;5;232m Run ]8;;ide:run:dplyr::last_dplyr_warnings()dplyr::last_dplyr_warnings()]8;; to see the 123211 remaining warnings.[39m
"
"1","[38;5;232m`summarise()` has grouped output by 'ref_id', 'Visitor_ID', 'Visit Number', 'Date'. You can override using the
`.groups` argument.[39m
"
