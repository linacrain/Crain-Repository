"0","post_data%>%
  group_by(.row,other.web.sites,search.engines,social.networks,typed_bookmarked,last_touch_referrer,.category,visitor_access_level,total_days)%>%
  summarise(m=mean(.value))%>%
  ungroup()%>%
  mutate(
         `other_.web_sites`=ifelse(last_touch_referrer==""other web sites"",`other.web.sites`+1,`other.web.sites`),
         `search.engines`=ifelse(last_touch_referrer==""search engines"",`search.engines`+1,`search.engines`),
         `social.networks`=ifelse(last_touch_referrer==""social networks"",`social.networks`+1,`social.networks`),
         `typed_bookmarked`=ifelse(last_touch_referrer==""typed/bookmarked"",`typed_bookmarked`+1,`typed_bookmarked`))%>%
  mutate(channel_level=ifelse(`other.web.sites`==0&`search.engines`==0&`social.networks`==0&`typed_bookmarked`==0,""missing"",
                              ifelse(`other.web.sites`>0&`search.engines`==0&`social.networks`==0&`typed_bookmarked`==0,'other.web.sites',
                                     ifelse(`other.web.sites`==0&`search.engines`>0&`social.networks`==0&`typed_bookmarked`==0,'search.engines',
                                            ifelse(`other.web.sites`==0&`search.engines`==0&`social.networks`>0&`typed_bookmarked`==0,'social.networks',
                                                   ifelse(`other.web.sites`==0&`search.engines`==0&`social.networks`==0&`typed_bookmarked`>0,'typed_bookmarked','Multi-channel'))))))%>%
   gather(referrer_source,visit_count,other.web.sites:typed_bookmarked)%>%
  group_by(.row,.category,last_touch_referrer,visitor_access_level)%>%
  summarise(m=mean(m),
            n_distinct_channels=n_distinct(ifelse(visit_count>0,referrer_source,NA),na.rm=TRUE))%>%
  ungroup()%>%
  mutate(n_distinct_channels=as.character(n_distinct_channels))%>%
  mutate(n_distinct_channels=as.factor(n_distinct_channels))%>%
  group_by(.category,last_touch_referrer,visitor_access_level,n_distinct_channels)%>%
  summarise(m=mean(m))%>%
  mutate(m=round(m*100,1))%>%
  ggplot(aes(x=n_distinct_channels,y=m,color=last_touch_referrer,group=last_touch_referrer))+geom_point(alpha=0.3)+geom_line(alpha=0.5)+facet_grid(vars(.category),vars(visitor_access_level),)+theme(axis.text.x = element_text(angle = 90,vjust=-0.2),panel.background = element_rect(fill = ""white"", colour = ""grey50""))+labs(x=""# Distinct Channels"",y=""Avg. Expected Probability of "")
"
"1","[38;5;232m`summarise()` has grouped output by '.row', 'other.web.sites', 'search.engines', 'social.networks',
'typed_bookmarked', 'last_touch_referrer', '.category', 'visitor_access_level'. You can override using the `.groups`
argument.[39m
"
"1","[38;5;232m`summarise()` has grouped output by '.row', '.category', 'last_touch_referrer'. You can override using the `.groups`
argument.[39m
"
"1","[38;5;232m`summarise()` has grouped output by '.category', 'last_touch_referrer', 'visitor_access_level'. You can override using
the `.groups` argument.[39m
"
